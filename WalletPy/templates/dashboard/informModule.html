{% load static %} {% load custom_filter %} {% block content %}
<div class="flow-root h-full relative">
	<!-- Div toggled on click on "+" -->
	<div id="cover" class="w-full absolute z-50 bg-white">
		<p id="coinName" class="text-xl font-extrabold p-5"></p>
		<div onclick='handleToggle()' class="absolute right-0 p-4 top-0 cursor-pointer">
			<svg class="h-6 w-6 " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
				<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM175 208.1L222.1 255.1L175 303C165.7 312.4 165.7 327.6 175 336.1C184.4 346.3 199.6 346.3 208.1 336.1L255.1 289.9L303 336.1C312.4 346.3 327.6 346.3 336.1 336.1C346.3 327.6 346.3 312.4 336.1 303L289.9 255.1L336.1 208.1C346.3 199.6 346.3 184.4 336.1 175C327.6 165.7 312.4 165.7 303 175L255.1 222.1L208.1 175C199.6 165.7 184.4 165.7 175 175C165.7 184.4 165.7 199.6 175 208.1V208.1z"/>
			</svg>
		</div>
		<canvas id="coinChart" class="w-80"></canvas>
		<div class="flex text-center text-gray-500 py-4">
			<a class="flex-1 w-fit"><span id="heureC" onclick="loadCoinGraph(this, '1H')"
			                              class="hover:bg-green-300 hover:bg-opacity-50 focus:bg-blue-300 focus:bg-opacity-50 transition-all rounded-2xl py-2 px-4 cursor-pointer">1H</span></a>
			<a class="flex-1 w-fit"><span id="jourC" onclick="loadCoinGraph(this, '1D')"
			                              class="hover:bg-green-300 hover:bg-opacity-50 transition-all rounded-2xl py-2 px-4 cursor-pointer">1D</span></a>
			<a class="flex-1 w-fit"><span id="semaineC" onclick="loadCoinGraph(this, '1W')"
			                              class="hover:bg-green-300 hover:bg-opacity-50 transition-all rounded-2xl py-2 px-4 cursor-pointer">1W</span></a>
			<a class="flex-1 w-fit"><span id="moisC" onclick="loadCoinGraph(this, '1M')"
			                              class="hover:bg-green-300 hover:bg-opacity-50 transition-all rounded-2xl py-2 px-4 cursor-pointer">1M</span></a>
			<a class="flex-1 w-fit"><span id="anneeC" onclick="loadCoinGraph(this, '1Y')"
			                              class="hover:bg-green-300 hover:bg-opacity-50 transition-all rounded-2xl py-2 px-4 cursor-pointer">1Y</span></a>
			<a class="flex-1 w-fit"><span id="tAnneeC" onclick="loadCoinGraph(this, '2Y')"
			                              class="hover:bg-green-300 hover:bg-opacity-50 transition-all rounded-2xl py-2 px-4 cursor-pointer">2Y</span></a>
		</div>
		<span class="text-xl font-extrabold p-5 mb-2">Description</span>
		<div class="overflow-y-auto overflow-x-hidden mt-4 h-2/5 ">
			<p id="coinDesc" class="text-justify text-sm h-full"></p>
		</div>
	</div>
	<div class="w-full mb-2 bg-white rounded overflow-hidden shadow-lg">
		<div class="px-6 py-4">
			<div class="font-bold text-xl mb-2">Limite infini de retrait</div>
			<p class="text-gray-700 text-base">
				Déposer et retirer en toute sécurité avec WalletPY en ayant aucune contrainte de limite.
			</p>
		</div>
	</div>
	<div class="w-full mb-2 bg-white px-6 py-4 rounded overflow-hidden shadow-lg">
		<div id="h-slider" class="container">
			{% for name, coin in coin_data.items %}
			<img class="my-auto mx-0" src="{{ coin.thumb }}" alt="btc icon"/>
			<div class="px-4 flex-shrink-0 w-32 border-dashed border-r-2 mr-4 mb-3 border-grey-600">
				<div>
					{% if user.is_authenticated %}
					<a id="fav-icon" class="items-center flex h-4 w-4 my-auto mx-0"
					   href="{% url 'favorite_add' coin.internal_id %}">
						<h3 class="mr-3 font-semibold text-sm text-gray-400">
							{{ coin.symbol|upper }}
						</h3>
						{% if coin.is_favorite %}
						<img src="{% static 'star-solid.svg' %}" alt=""/>
						{% else %}
						<img src="{% static 'star-regular.svg' %}" alt=""/>
						{% endif %}
					</a>
					{% endif %}
					<div class="flex justify-between">
						<div>
							<h1 class="font-semibold text-xl text-gray-700">
								{{ user.preferred_currency.symbol }} {{ coin.current_price|floatformat:-2 }}
							</h1>
							{% if coin.price_change_percentage_24h < 0 %}
							<span class="font-bold text-red-500"
							>{{ coin.price_change_percentage_24h|floatformat}} %</span
							><br/>
							{% else %}
							<span class="font-bold text-green-500"
							>{{ coin.price_change_percentage_24h|floatformat}} %</span
							><br/>
							{% endif %}
						</div>
					</div>
					<div id={{coin.name}} class="hidden">{{coin.description|removeBadStr|encode}}</div>
					<div class="hover:bg-gray-200 bg-gray-100 rounded py-1 mt-2 cursor-pointer"
					     onclick='handleToggle("{{coin.name}}")'><img class="mx-auto w-3 h-3"
					                                                  src="{% static 'plus-solid.svg' %}" alt=""></div>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>
	<div class="w-full bg-white rounded overflow-hidden shadow-lg">
		<div class="px-6 py-4">
			<div class="font-bold text-xl mb-2">Mes favoris</div>
			<div class="flex overflow-x-auto">
				{% if user.is_authenticated %}
				{% for favorite in user.favorite_coins.all %}
				{% with fav_coin=coin_data|get_item:favorite.name %}
				<img class="my-auto mx-0" src="{{ fav_coin.thumb }}" alt="btc icon"/>
				<div class="px-4 flex-shrink-0 border-dashed border-r-2 mr-4 mb-3 border-grey-600 cursor-pointer"
				     onclick='handleToggle("{{fav_coin.name}}")'>
					<div>
						<h3 class="font-semibold text-sm text-gray-400">
							{{ fav_coin.symbol|upper }}
						</h3>
						<div class="flex justify-between">
							<div>
								<h1 class="font-semibold text-xl text-gray-700">
									 {{ user.preferred_currency.symbol }} {{ fav_coin.current_price }}
								</h1>
								{% if fav_coin.price_change_percentage_24h < 0 %}
								<span class="font-bold text-red-500"
								>{{ fav_coin.price_change_percentage_24h|floatformat}} %</span
								><br/>
								{% else %}
								<span class="font-bold text-green-500"
								>{{ fav_coin.price_change_percentage_24h|floatformat}} %</span
								><br/>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
				{% endwith %} {% endfor %}
				{% else %}
				<a class="font-bold text-indigo-500" href="{% url 'login' %}">Connectez-vous</a> pour accèder à vos
				favoris
				{% endif %}
			</div>
		</div>
	</div>
	<div class="w-full mt-6 bg-white rounded shadow-lg">
		<div class="px-6 py-4">
			<div class="font-bold text-xl mb-4">Mon historique des transactions</div>
			<div class="flow-root text-center">
				<ul role="list" class="-mb-8">
					<li>
						<div class="relative pb-8">
							<span class="absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200"
							      aria-hidden="true"></span>
							<div class="relative flex space-x-3">
								<div>
            <span class="h-8 w-8 rounded-full bg-red-400 flex items-center justify-center ring-8 ring-white">
	            <svg class="h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
	                 fill="currentColor">
		            <path d="M285.6 444.1C279.8 458.3 264.8 466.3 249.8 463.4C234.8 460.4 223.1 447.3 223.1 432V256H47.1C32.71 256 19.55 245.2 16.6 230.2C13.65 215.2 21.73 200.2 35.88 194.4L387.9 50.38C399.8 45.5 413.5 48.26 422.6 57.37C431.7 66.49 434.5 80.19 429.6 92.12L285.6 444.1z"/>
	            </svg>
            </span>
								</div>
								<div class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4">
									<div>
										<p class="text-sm text-gray-500">Envoie vers userX</p>
									</div>
									<div class="text-right text-sm whitespace-nowrap text-gray-500">
										<time>Sep 20 2021</time>
										<p class="text-sm text-red-500">-278 </p>
									</div>
								</div>
							</div>
						</div>
					</li>
					<li>
						<div class="relative pb-8">
							<div class="relative flex space-x-3">
								<div>
            <span class="h-8 w-8 rounded-full bg-green-500 flex items-center justify-center ring-8 ring-white">
              <svg class="h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                   fill="currentColor"><path
		              d="M342.6 374.6l-128 128C208.4 508.9 200.2 512 191.1 512s-16.38-3.125-22.63-9.375l-127.1-128c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 402.8V80C160 71.19 152.8 64 144 64H32C14.33 64 0 49.69 0 32s14.33-32 32-32h112C188.1 0 224 35.88 224 80v322.8l73.37-73.38c12.5-12.5 32.75-12.5 45.25 0S355.1 362.1 342.6 374.6z"/></svg>
            </span>
								</div>
								<div class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4">
									<div>
										<p class="text-sm text-gray-500">Reçu de User Y</p>
									</div>
									<div class="text-right text-sm whitespace-nowrap text-gray-500">
										<time datetime="2020-10-04">Oct 4, 2021</time>
										<p class="text-sm text-green-500">+308 {{ user.preferred_currency.symbol }}</p>
									</div>
								</div>
							</div>
						</div>
					</li>
				</ul>
				<span class="mt-3 cursor-pointer inline-block animate-bounce rounded-full p-2 shadow-lg bg-yellow-300 text-white">
        <svg class="w-6 h-6 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 13l-7 7-7-7m14-8l-7 7-7-7"/>
        </svg>
    </span>
			</div>
		</div>
	</div>
</div>
<style lang="css">
	#cover {
		height: 100%;
		overflow: hidden;
		max-height: 0;
		transition: max-height 1.5s ease-out;
	}
	
	#cover.active {
		transition: max-height 1.5s ease-in;
		max-height: 100%;
	}
	
	.container {
		display: flex;
		width: 100%;
	}
	
	#h-slider {
		animation-name: slide;
		animation-duration: 30s;
		animation-timing-function: linear;
		animation-iteration-count: infinite;
	}
	
	@keyframes slide {
		0% {
			transform: translate3d(0, 0, 0);
		}
		50% {
			transform: translate3d(-150%, 0, 0); /* The image width */
		}
		100% {
			transform: translate3d(0, 0, 0); /* The image width */
		}
	}

</style>
<script src="/static/js/dashboardInfo.js"></script>
{% endblock %}
