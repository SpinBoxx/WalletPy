{% extends "base.html" %} {% block content %} {% load static %}

<div class="block">
    <h1 class="text-3xl font-bold py-5 pl-10">Mon compte</h1>
    <div class="max-w-2xl mx-auto">
        <div class="w-full">
            <div class="w-full bg-blue-600 h-24 rounded-t-lg"></div>
            <div class="absolute -mt-20 ml-10">
                <img class="w-28 mt-5" src="{% static 'logo.ico' %}" />
            </div>
            <div class="absolute ml-40 flex flex-row">
                <label class="font-bold">{{user.username}}</label>
            </div>
        </div>
        <form name="updateUser" action="update/" method="POST">
            {% csrf_token %}
            <div class="bg-primary bg-white border border-primary rounded-b-lg p-5 pt-20">
                <div class="bg-primary border border-primary rounded p-2 text-center">
                    <label class="font-bold">Mes informations :</label>
                    <div class="flex flex-col pt-4 pb-2">
                        <div class="flex flex-col lg:flex-row mx-auto lg:mx-0">
                            <label class="font-bold mb-2 lg:mb-0 lg:mr-2 leading-10">Pseudo :</label>
                            <input type="text" id="id_username" name="username" maxlength="20"
                                placeholder="{{user.username}}"
                                class="text-sm sm:text-base relative w-52 border rounded placeholder-gray-400 focus:border-indigo-400 focus:outline-none py-2 pr-2 pl-2">
                        </div>
                        <label class="text-left py-5 text-center lg:text-left"><strong>Email :
                            </strong>{{user.email}}</label>
                        <div id="password" class="flex flex-col lg:flex-row mx-auto lg:mx-0">
                            <label class="font-bold leading-10">Mot de passe: </label>
                            <input type="password" id="id_new_password" name="new_password"
                                placeholder="Nouveau mot de passe"
                                class="lg:mx-2 border border-gray-300 w-52 px-4 py-2 rounded-md text-md text-gray-700 outline-none">
                            <input type="password" id="id_confirm_password" name="confirm_password"
                                placeholder="Confirmer mot de passe"
                                class="border border-gray-300 w-52 px-4 py-2 rounded-md text-md text-gray-700 outline-none">
                        </div>
                        <div class="flex flex-col lg:flex-row mx-auto lg:mx-0">
                            <label class="text-left py-5 text-center lg:text-left"> <strong>Monnaie conversion
                                    :</strong> </label>
                            <select name="pref_fiat" class="lg:mx-2 border border-gray-300 p-2 w-52 lg:m-4 rounded-md text-md text-gray-700 outline-none"
                                aria-label="Default select example">
                                {% for fiat in available_fiat %}
                                <option {% if fiat.short_name == user.preferred_currency.short_name %} selected {% endif %} value="{{fiat.id}}">{{fiat.short_name|upper}} ({{fiat.symbol}})</option>
                                {% endfor %}
                            </select>
                        </div>

                    </div>
                    <button type="submit" onClick="validate()" value="submit"
                        class="mt-3 bg-indigo-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Confirmer</button>
                </div>
                {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                    <li{% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
                        {% endfor %}
                </ul>
                {% endif %}
            </div>
        </form>
    </div>
</div>

<script>
    var password = document.getElementById("id_new_password");
    var confirm_password = document.getElementById("id_confirm_password");
    function validate() {
        if (password.value != confirm_password.value) {
            confirm_password.setCustomValidity("Mot de passe pas identique");
        } else {
            confirm_password.setCustomValidity("");
        }
    }
    password.onchange = validatePassword;
    confirm_password.onkeyup = validatePassword;
</script>

{% endblock %}